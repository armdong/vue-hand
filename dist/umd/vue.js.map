{"version":3,"file":"vue.js","sources":["../../src/utils.js","../../src/observer/array.js","../../src/observer/index.js","../../src/state.js","../../src/init.js","../../src/index.js"],"sourcesContent":["export function isObject(obj) {\n  return typeof obj === \"object\" && obj !== null;\n}\n\nexport function def(data, key, value) {\n  Object.defineProperty(data, key, {\n    enumerable: false,\n    configurable: false,\n    value,\n  });\n}\n\nexport function proxy(data, source, key) {\n  Object.defineProperty(data, key, {\n    get() {\n      return data[source][key];\n    },\n    set(newValue) {\n      data[source][key] = newValue;\n    },\n  });\n}\n","const arrayProto = Array.prototype;\nexport let arrayMethods = Object.create(arrayProto);\n\nconst methods = [\n  \"push\",\n  \"pop\",\n  \"shift\",\n  \"unshift\",\n  \"sort\",\n  \"reverse\",\n  \"splice\",\n];\n\nmethods.forEach((method) => {\n  arrayMethods[method] = function (...args) {\n    const results = arrayProto[method].apply(this, args);\n    const ob = this.__ob__;\n    let inserted;\n    switch (method) {\n      case \"push\":\n      case \"unshift\":\n        inserted = args;\n        break;\n      case \"splice\":\n        inserted = args.slice(2);\n        break;\n    }\n    if (inserted) ob.observeArray(inserted); // 对新增的每一项进行观测\n    return results;\n  };\n});\n","import { isObject, def } from \"../utils\";\nimport { arrayMethods } from \"./array\";\n\nclass Observer {\n  constructor(value) {\n    // 给每个属性添加一个__ob__属性，这个属性不可枚举，不可删除\n    // 如果有这个属性，表示该属性已经被观测过了\n    def(value, \"__ob__\", this);\n    if (Array.isArray(value)) {\n      value.__proto__ = arrayMethods;\n      this.observeArray(value);\n    } else {\n      this.walk(value);\n    }\n  }\n\n  walk(data) {\n    for (let key in data) {\n      defineReactive(data, key, data[key]);\n    }\n  }\n\n  observeArray(data) {\n    data.forEach(observe);\n  }\n}\n\nfunction defineReactive(data, key, value) {\n  observe(value);\n  Object.defineProperty(data, key, {\n    get() {\n      return value;\n    },\n    set(newValue) {\n      if (value === newValue) return;\n      observe(newValue);\n      value = newValue;\n    },\n  });\n}\n\nexport function observe(data) {\n  if (!isObject(data)) {\n    return data;\n  }\n  return new Observer(data);\n}\n","import { observe } from \"./observer/index\";\nimport { proxy } from \"./utils\";\n\nexport function initState(vm) {\n  const opts = vm.$options;\n\n  if (opts.props) {\n    initProps(vm);\n  }\n  if (opts.methods) {\n    initMethods(vm);\n  }\n  if (opts.data) {\n    initData(vm);\n  }\n  if (opts.computed) {\n    initComputed(vm);\n  }\n  if (opts.watch) {\n    initWatch(vm);\n  }\n}\n\nfunction initProps(vm) {}\nfunction initMethods(vm) {}\nfunction initData(vm) {\n  let data = vm.$options.data;\n  vm._data = data = typeof data === \"function\" ? data.call(vm) : data;\n  for (let key in data) {\n    proxy(vm, \"_data\", key);\n  }\n  observe(data);\n}\nfunction initComputed(vm) {}\nfunction initWatch(vm) {}\n","import { initState } from \"./state\";\n\nexport function initMixin(Vue) {\n  Vue.prototype._init = function (options) {\n    const vm = this;\n    vm.$options = options;\n\n    // 初始化状态\n    initState(vm);\n\n    // TODO: 初始化事件，初始化生命周期，初始化watch等等\n  };\n}\n","import { initMixin } from \"./init\";\n\nfunction Vue(options) {\n  // 初始化\n  this._init(options);\n}\n\n// 原型扩展 -> 初始化\ninitMixin(Vue);\n\nexport default Vue;\n"],"names":["isObject","obj","def","data","key","value","Object","defineProperty","enumerable","configurable","proxy","source","get","set","newValue","arrayProto","Array","prototype","arrayMethods","create","methods","forEach","method","args","results","apply","ob","__ob__","inserted","slice","observeArray","Observer","isArray","__proto__","walk","defineReactive","observe","initState","vm","opts","$options","props","initData","computed","watch","_data","call","initMixin","Vue","_init","options"],"mappings":"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"}